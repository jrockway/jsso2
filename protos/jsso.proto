syntax = "proto3";
package jsso;
import "types.proto";

option go_package = "github.com/jrockway/jsso2/pkg/jssopb";

// Service User manages user accounts.
service User {
    // Edit adds a new user if the ID is 0, or updates an existing user.
    rpc Edit(EditUserRequest) returns (EditUserReply) {
    }
}

// Service Login manages the WebAuthn login ceremony.
service Login {
    rpc Start(StartLoginRequest) returns (StartLoginReply) {
    }
}

// Service Enrollment manages the WebAuthn enrollment ceremony.
service Enrollment {
    rpc Start(StartEnrollmentRequest) returns (StartEnrollmentReply) {
    }
}

message EditUserRequest {
    types.User user = 1;
}

message EditUserReply {
    types.User user = 1;
}

message StartLoginRequest {
}
message StartLoginReply {
}

message StartEnrollmentRequest {
    string enrollment_token = 1;
}

message StartEnrollmentReply {
}
